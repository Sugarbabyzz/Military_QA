### 1. 版本历史	

| 修订日期   | 版本号 | 修订人 | 备注 |
| ---------- | ------ | ------ | ---- |
| 2020.08.07 | 1.0    | 唐     |      |

### 2. 调用说明

- 调用前提

  需能够访问231服务器，并将data文件夹放在项目根目录，作为分词器词典。

  添加jar包依赖，在程序中调用方法即可。

- 调用类方法

  ```java
  String qa_main(String uid, String question, String q_time)
  ```

- 调用参数说明

  | 参数名   | 参数类型 | 说明                                          |
  | -------- | -------- | --------------------------------------------- |
  | uid      | String   | 用户id                                        |
  | question | String   | 问句                                          |
  | q_time   | String   | 用户提问时间（推荐 yyyy-MM-dd HH:mm:ss 格式） |

- 调用示例

  ```java
  MultiMilitaryQA QA = new MultiMilitaryQA();
  String answer = QA.qa_main("用户id", "中国的战斗机有哪些？", new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date()));
  ```

- 返回结果

  每次问答结果以 **JSON** 字符串返回。

### 3. 返回字段说明

#### 1. 百科模式（Q_type = 1）

​	从百科中返回答案涉及的实体或属性。

​	如果 A_type = 1，则重点展示搜索到的实体属性，可以利用实体id显示相应实体词条；如果 A_type = 2，则直接展示相应实体词条，对于答案结果数量过多的做一些筛除。

| 字段名 | 字段类型  | 说明                                                         | 是否一定存在 |
| ------ | --------- | ------------------------------------------------------------ | ------------ |
| Q_type | Integer   | 必为 1                                                       | 是           |
| A_type | Integer   | 1：属性  2：实体                                             | 是           |
| Answer | JSONArray | entity_id（Integer） 实体id<br />entity_name（String） 实体名<br />attr_name（String） 属性名（A_type=2时无此字段）<br />attr_value（String）属性值（A_type=2时无此字段） | 是           |

- 示例

  1. Question：**歼5和歼20的长度是多少？**

     ```json
     {
     	"Q_type": 1,
     	"A_type": 1,
     	"Answer": [{
     		"entity_name": "歼-5战斗机",
     		"attr_name": "长度",
     		"entity_id": 2560,
     		"attr_value": "11.68米"
     	}, {
     		"entity_name": "歼-20战斗机",
     		"attr_name": "长度",
     		"entity_id": 2847,
     		"attr_value": "20.3米"
     	}]
     }
     ```

  2. Question：**长度大于25米的战斗机有哪些？**

     ```json
     {
     	"Q_type": 1,
     	"A_type": 2,
     	"Answer": [{
     		"entity_name": "XF-108轻剑战斗机",
     		"entity_id": 2385
     	}, {
     		"entity_name": "YF-12战斗机",
     		"entity_id": 2036
     	}]
     }
     ```

#### 2. 对比模式（Q_type = 2）

​	从百科中返回需要对比的实体。

​	根据实体id展示需要对比的实体，对相同的属性进行比对比较。

| 字段名 | 字段类型  | 说明                                                         | 是否一定存在 |
| ------ | --------- | ------------------------------------------------------------ | ------------ |
| Q_type | Integer   | 必为2                                                        | 是           |
| Answer | JSONArray | entity_id（Integer） 实体id<br />entity_name（String） 实体名 | 是           |

- 示例

  Question：**我想对比一下神舟五号和神舟六号**

  ```json
  {
  	"Q_type": 2,
  	"Answer": [{
  		"entity_name": "神舟五号",
  		"entity_id": 37
  	}, {
  		"entity_name": "神舟六号载人飞船",
  		"entity_id": 36
  	}]
  }
  ```

#### 3. 热点模式（Q_type = 3）

​	通过语义解析提取问句中的时间及搜索关键词，从而在搜索库中查找相应热点资讯。

​	时间抽取为左闭右开方式。

| 字段名       | 字段类型           | 说明                                                         | 是否一定存在 |
| ------------ | ------------------ | ------------------------------------------------------------ | ------------ |
| Q_type       | Integer            | 必为3                                                        | 是           |
| Q_content    | List&lt;String&gt; | 搜索关键词（无法解析出关键词时，列表可能为空）               | 是           |
| Q_start_time | String             | 起始时间（问句中不涉及时间，则不存在该字段）                 | 否           |
| Q_end_time   | String             | 结束时间（无法从语义中解析结束时间，则不存在该字段，需要后台补充一个结束时间） | 否           |

- 示例

  Question：**我想看去年五月至七月有关歼20战斗机的热点新闻**

  ```json
  {
  	"Q_type": 3,
  	"Q_content": ["歼20", "战斗机"],
  	"Q_start_time": "2019-05-01 00:00:00",
    "Q_end_time": "2019-07-01 00:00:00"
  }
  ```

#### 4. 直达模式（Q_type = 4）

​	通过语义解析用户的跳转意图。

| 字段名 | 字段类型 | 说明                                                | 是否一定存在 |
| ------ | -------- | --------------------------------------------------- | ------------ |
| Q_type | Integer  | 必为4                                               | 是           |
| Answer | Integer  | 1：头条  2：百科  3：订阅  4：我的收藏  5：浏览历史 | 是           |

- 示例

  Question：**打开我的收藏**

  ```json
  {
  	"Q_type": 4,
  	"Answer": 4
  }
  ```

#### 5. 辅助模式（Q_type = 5）

​	用户输入一个较大概念的类别名词（一级类别），返回用户一些较小概念的类别名（二级类别），前台可以提示用户使用这些二级类别名来搜索，从而达到辅助用户使用问答系统的目的。

| 字段名 | 字段类型           | 说明           | 是否一定存在 |
| ------ | ------------------ | -------------- | ------------ |
| Q_type | Integer            | 必为5          | 是           |
| Answer | List&lt;String&gt; | 二级类别名列表 | 是           |

- 示例

  Question：**枪**

  ```json
  {
  	"Q_type": 5,
  	"Answer": ["非自动步枪", "自动步枪", "冲锋枪", "狙击枪", "手枪", "机枪", "霰弹枪", "火箭筒", "榴弹发射器"]
  }
  ```

#### 6. 未检索到答案的情况

​	无论 **Q_type** 为多少，**Answer字段为空** 即为未找到答案。

